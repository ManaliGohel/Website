@{
    ViewData["Title"] = "Service History";
    Layout = "_ServiceLayout";
}

<div class="dvWelcome d-flex justify-content-center align-items-center">
    Welcome,&nbsp;<span id="cusname" class="fw-bold">@ViewBag.UserName</span>
</div>
<section class="container my-4 d-flex justify-content-center">
    <div class="x dv-ser-pro-menu me-3">
        <a id="lnkcus-dashboard" href="#" onclick="showcusDashboard('lnkcus-dashboard');">Dashboard</a>
        <a id="lnkcus-serhistory" href="#" onclick="showcusSerhistory('lnkcus-serhistory');">Service History</a>
        <a id="lnkcus-serschedule" href="#" onclick="showcusSerschedule('lnkcus-serschedule');">Service Schedule</a>
        <a id="lnkcus-favpros" href="#" onclick="showcusFavpros('lnkcus-favpros');">Favourite Pros</a>
        <a id="lnkcus-invoices" href="#" onclick="showcusInvoices('lnkcus-invoices');">Invoices</a>
        <a id="lnkcus-notifications" href="#" onclick="showcusNotifications('lnkcus-notifications');">Notifications</a>
    </div>
    <div id="sidebarlink_container" class="ser-provider-submenu-list">
        <div id="dvcus-dashboard">
            <div>
                <label class="serhisPageTitle pb-2 float-start mb-2">Current Service Requests</label>
                <a class="btnratesp px-3 py-2 float-end mb-2" asp-action="bookservice" asp-controller="Customer">Add New Service Request</a>
            </div>
            <table id="tblcusDashboard" class="table-data mb-3" style="width:100%">
                <thead>
                    <tr>
                        <th>Service ID</th>
                        <th>Service Date</th>
                        <th>Service Provider</th>
                        <th>Payment</th>
                        <th data-orderable="false">Actions</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
        <div id="dvcus-serhistory">
            <label class="serhisPageTitle pb-2">Service History</label>
            <table id="tblcusServiceHistory" class="table-data mb-3" style="width:100%">
                <thead>
                    <tr>
                        <th>Service ID</th>
                        <th>Service Details</th>
                        <th>Service Provider</th>
                        <th>Payment</th>
                        <th>Status</th>
                        <th data-orderable="false">Rate SP</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div id="dvcus-serschedule">Service Schedule</div>
        <div id="dvcus-favpros">
            <div class="dvfavproscustomer">
                <table id="tblFavProsCustomer" class="favpros mb-3" style="width:100%">
                    <thead class="d-none">
                        <tr>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody class="row row-cols-1 row-cols-md-2 g-4 mt-0">
                    </tbody>
                </table>
            </div>
        </div>
        <div id="dvcus-invoices">Invoices</div>
        <div id="dvcus-notifications">Notifications</div>
        <div id="dvcus-mysettings">
            <div class="d-flex justify-content-center align-items-center">
                <div class="fw-bold cusMySettingstb d-flex justify-content-center align-items-center" id="lnkcusMysettingsMydetails" onclick="showcusMySettingsTb('dvcus-mysettings-mydetails')">
                    <span class="spncussettingstabstxt">My Details</span>
                    <div class="dvcussettingsimg">
                        <img src="~/images/service-history/my-account-details.png" id="imgCusMydetails" />
                    </div>
                </div>
                <div class="fw-bold cusMySettingstb d-flex justify-content-center align-items-center" id="lnkcusMysettingsMyaddresses" onclick="showcusMySettingsTb('dvcus-mysettings-myaddresses')">
                    <span class="spncussettingstabstxt">My Addresses</span>
                    <div class="dvcussettingsimg">
                        <img src="~/images/service-history/my-account-address.png" id="imgCusMyaddresses" />
                    </div>
                </div>
                <div class="fw-bold cusMySettingstb d-flex justify-content-center align-items-center" id="lnkcusMysettingsChangepassword" onclick="showcusMySettingsTb('dvcus-mysettings-changepassword')">
                    <span class="spncussettingstabstxt">Change Password</span>
                    <div class="dvcussettingsimg">
                        <img src="~/images/service-history/my-account-password.png" id="imgCusChangepassword" />
                    </div>
                </div>
            </div>
            <div id="dvcus-mysettings-mydetails" class="mt-3 mb-5">
                <div class="row">
                    <div class="col-md-12 mb-2">
                        <div class="alert alert-success" id="dvCusUpdateSuccess">
                            <strong>Success!</strong> Customer has been updated Successfully!!
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 mb-2">
                        <label class="fw-bold">First name</label>
                        <input type="text" class="form-control text-capitalize" id="txtFirstnameCusMydetails" onkeyup="validateCustomerMydetails();" autocomplete="off" maxlength="100" />
                        <span class="text-danger small" id="spnFirstnameCusMydetails"></span>
                    </div>
                    <div class="col-md-4 mb-2">
                        <label class="fw-bold">Last name</label>
                        <input type="text" class="form-control text-capitalize" id="txtLastnameCusMydetails" onkeyup="validateCustomerMydetails();" autocomplete="off" maxlength="100" />
                        <span class="text-danger small" id="spnLastnameCusMydetails"></span>
                    </div>
                    <div class="col-md-4 mb-2">
                        <label class="fw-bold">E-mail address</label>
                        <input type="email" class="form-control" id="txtEmailCusMydetails" autocomplete="off" maxlength="100" readonly />
                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col-md-4 mb-2">
                        <label class="fw-bold">Mobile number</label>
                        <div class="input-group">
                            <div class="input-group-text">+49</div>
                            <input class="form-control" id="txtMobileCusMydetails" onkeyup="validateCustomerMydetails();" autocomplete="off" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" type="number" maxlength="10" autocomplete="off" />
                        </div>
                        <span class="text-danger small" id="spnMobileCusMydetails"></span>
                    </div>
                    <div class="col-md-4 mb-2">
                        <label class="fw-bold">Date of Birth</label>
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="wdate">
                                <select class="form-select select" id="selcusMyDetailsDOBDate" onchange="validateCustomerMydetails();"></select>
                            </div>
                            <div class="wmonth">
                                <select class="form-select select" id="selcusMyDetailsDOBMonth" onchange="validateCustomerMydetails();"></select>
                            </div>
                            <div class="wyear">
                                <select class="form-select select" id="selcusMyDetailsDOBYear" onchange="validateCustomerMydetails();"></select>
                            </div>
                        </div>
                        <span class="text-danger small" id="spnDOBCusMydetails"></span>
                    </div>
                </div>
                <hr class="hr-setup-ser" />
                <div class="row">
                    <div class="col-md-4 mb-2">
                        <label class="fw-bold">My Preferred Language</label>
                        <select class="form-select select" id="selcusMyDetailsPreferredLanguage">
                            @{
                                int count = 0;
                                foreach (int i in Enum.GetValues(typeof(PreferredLanguageEnum)))
                                {
                                    if (count == 0)
                                    {
                                        <option value=@i selected>@Enum.GetName(typeof(PreferredLanguageEnum), @i)</option>
                                        count++;
                                    }
                                    else
                                    {
                                        <option value=@i>@Enum.GetName(typeof(PreferredLanguageEnum), @i)</option>
                                    }
                                }
                            }
                        </select>
                    </div>
                </div>
                <button class="btnContinueSetupSerProc px-4 py-2 mt-2" id="btnsaveCustomerDetails" onclick="saveCustomerDetails();">Save</button>
            </div>
            <div id="dvcus-mysettings-myaddresses" class="mt-3 mb-5">
                <div id="dvUserAddresses"></div>
                <button class="btnContinueSetupSerProc px-4 py-2 mt-3" onclick="openAddEditUserAddressModal('', '');">Add New Address</button>
            </div>
            <div id="dvcus-mysettings-changepassword" class="mt-3 mb-5">
                <div class="row">
                    <div class="col-md-12 mb-2">
                        <div class="alert alert-success" id="dvCusChangePassword">
                            <strong>Success!</strong> Password has been updated Successfully!!
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="fw-bold">Old Password</label>
                        <input type="text" class="form-control" placeholder="Old Password" id="txtoldpwdUserchangepwd" autocomplete="off" maxlength="100" />
                        <span class="text-danger small" id="spnoldpwdUserchangepwd"></span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="fw-bold">New Password</label>
                        <input type="text" class="form-control" placeholder="New Password" id="txtnewpwdUserchangepwd" data-bs-toggle="tooltip" data-bs-placement="right" title="Password must be 6 to 14 Characters long, must contain at least one Upper case, one Lower case, one Digit and one Special character!" onfocusout="validateNewPassword();" autocomplete="off" maxlength="100" />
                        <span class="text-danger small" id="spnnewpwdUserchangepwd"></span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label class="fw-bold">Confirm Password</label>
                        <input type="text" class="form-control" placeholder="Confirm Password" id="txtconfirmnewpwdUserchangepwd" onfocusout="validateConfirmNewPassword();" autocomplete="off" maxlength="100" />
                        <span class="text-danger small" id="spnconfirmnewpwdUserchangepwd"></span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2">
                        <button id="btnCusChangepassword" onclick="changeCusPassword();" class="btnContinueSetupSerProc btnContinueSetupSerProcDisable px-5 py-2 mt-2" disabled>Save</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" id="hdncusActiveMenu" value="">
    <input type="hidden" id="hdncusAddressId" value="">
</section>

<!-- Modal 5 Add/Edit User Address -->
<div class="modal fade" id="addedituseraddressModal" aria-hidden="true" aria-labelledby="addedituseraddressModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <div class="mdlheader"><span id="spnAddEditCusAddressTitle"></span> Address</div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row m-2">
                    <div class="col-md-11 mb-1 ms-3 alert alert-danger alert-dismissible d-none" id="dvaddedituseraddressModalMsg" role="alert">
                        <span id="spnaddedituseraddressModalMsg"></span>
                        <button type="button" class="btn-close" onclick="" aria-label="Close"></button>
                    </div>
                </div>
                <div class="row m-2">
                    <div class="col-md-6 mb-1">
                        <label class="fw-bold">Street name</label>
                        <input type="text" class="form-control" id="txtStreetnameMdladdedit" onkeyup="validateAddEditUserAddressModal();" autocomplete="off" maxlength="200" />
                    </div>
                    <div class="col-md-6 mb-1">
                        <label class="fw-bold">House number</label>
                        <input type="text" class="form-control" id="txtHomenumberMdladdedit" onkeyup="validateAddEditUserAddressModal();" autocomplete="off" maxlength="200" />
                    </div>
                </div>
                <div class="row m-2">
                    <div class="col-md-6 mb-1">
                        <label class="fw-bold">Postal code</label>
                        <input class="form-control" type="number" id="txtPostalcodeMdladdedit" onkeyup="validateAddEditUserAddressModal(); fillCitiesByPostalcode(this.value);" maxlength="6" autocomplete="off" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" onkeypress="return event.charCode &gt;= 48 &amp;&amp; event.charCode &lt;= 57" />
                        <span class="text-danger small" id="spnPostalcodeMdladdedit"></span>
                    </div>
                    <div class="col-md-6 mb-1">
                        <label class="fw-bold">City</label>
                        <select class="form-select select" id="selCityCusMysettingsMdl"></select>
                    </div>
                </div>
                <div class="row m-2">
                    <div class="col-md-6 mb-1">
                        <label class="fw-bold">Mobile number</label>
                        <div class="input-group">
                            <div class="input-group-text">+49</div>
                            <input class="form-control" id="txtMobilenumberMdladdedit" onkeyup="validateAddEditUserAddressModal();" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" type="number" maxlength="10" autocomplete="off" />
                        </div>
                        <span class="text-danger small" id="spnMobilenumberMdladdedit"></span>
                    </div>
                </div>
                <div class="row m-2 mt-3">
                    <div class="col-md-12">
                        <input type="hidden" id="hdnCustomerEditAddressId" />
                        <button class="btnLogin btndisable" disabled id="btnaddedituseraddressModal" onclick="addEditUserAddress();"><span id="spnAddEditCusAddressBtntext"></span></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal 5 Delete User Address -->
<div class="modal fade" id="deleteuseraddressModal" aria-hidden="true" aria-labelledby="deleteuseraddressModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <div class="mdlheader">Delete Address</div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row m-2">
                    <div class="col-md-12">
                        Are you sure you want to delete this address?
                    </div>
                </div>
                <div class="row m-1">
                    <div class="col-md-12">
                        <input type="hidden" id="hdnDeleteCustomerAddressId" />
                        <button class="btnContinueSetupSerProc px-5 py-2 mt-1" onclick="deleteCustomerAddress();">Yes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal 5 Show Service Request Details -->
<div class="modal fade" id="showServiceRequestDetailsModal" aria-hidden="true" aria-labelledby="showServiceRequestDetailsModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <div class="mdlheader">Service Details</div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="dvServiceDetailsModalBody"></div>
            </div>
        </div>
    </div>
</div>

<!-- Modal 5 Reschedule Service Request -->
<div class="modal fade" id="rescheduleServiceRequestModal" aria-hidden="true" aria-labelledby="rescheduleServiceRequestModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <div class="mdlheader">Reschedule Service Request</div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body m-2">
                <div class="mb-3">
                    <span class="small text-danger" id="spnRescheduleServiceRequestMsg"></span>
                </div>                
                <div class="mb-1">Select New Date & Time</div>
                <div class="row mb-2">
                    <div class="col-md-6 pe-1">
                        <input type="date" id="dtRescheduleDateForService" min="@DateTime.Today.AddDays(1).ToString("yyyy-MM-dd")" class="dateForService calender-icon form-control mb-2 dateForServiceReschedule">
                    </div>
                    <div class="col-md-6 ps-1">
                        <select class="form-select select" id="selRescheduleTimeForService">
                            @{
                                for (int i = 8; i <= 17; i++)
                                {
                                    <option value="@i">@i:00</option>
                                    if (@i != 17)
                                    {
                                        <option value="@i.5">@i:30</option>
                                    }
                                }
                            }
                        </select>
                    </div>
                </div>
                <input type="hidden" id="hdnServiceRequestIdOfRescheduleSR" />
                <input type="hidden" id="hdnServiceDurationOfRescheduleSR" />
                <input type="hidden" id="hdnServiceProviderIdOfRescheduleSR" />
                <button class="btnLogin fs6" onclick="rescheduleServiceRequestValidation();">Update</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal 5 Delete Service Request -->
<div class="modal fade" id="deleteServiceRequestModal" aria-hidden="true" aria-labelledby="deleteServiceRequestModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <div class="mdlheader">Cancel Service Request</div>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body m-2">
                <label class="mb-1">Why do you want to cancel the service request?</label>
                <div class="row mb-2">
                    <div class="col-md-12">
                        <textarea class="form-control"></textarea>
                    </div>
                </div>
                <input type="hidden" id="hdncancelServiceRequestId" />
                <input type="button" class="btnLogin fs6" value="Cancel Now" onclick="cancelServiceRequest();" />
            </div>
        </div>
    </div>
</div>